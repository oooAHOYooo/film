<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Full Script - Creatures in the Tall Grass Script</title>
  <link rel="stylesheet" href="script.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="gallery-container">
    <div class="nav no-print">
      <div class="nav-left">
        <a href="index.html">← Back to Gallery</a>
      </div>
      <button type="button" class="print-button" onclick="window.print()">Print</button>
    </div>

    <div class="screenplay-container">
      <div class="full-script-header">
        <div class="full-script-title">Creatures in the Tall Grass Script — Full Script</div>
        <div class="full-script-meta">Compiled on 1/7/2026, 12:13:54 PM</div>
      </div>
      <div class="screenplay-content" id="scriptContent"></div>
    </div>
  </div>

  <script>
    const markdown = "# Creatures in the Tall Grass Script — Full Script\n\n*Compiled on 1/7/2026, 12:13:54 PM*\n\n---\n\n\n## ACT I — Arrival & Discovery\n\n---\n\n\n### Scene 1: Arrival & Discovery\n\n*ACT I — Arrival & Discovery | ID: arrival | File: 01_arrival.md*\n\n---\n\nINT. DALLAS' NEW HOUSE - DAY\n\nDallas finishes unpacking boxes. The room is sparse, filled with moving boxes and a few pieces of furniture.\n\nHe hears a noise from outside. Curious, he opens a box marked \"EQUIPMENT.\"\n\nDallas pulls out a heavy, military-grade receiver. It's covered in dust. He peels back a piece of duct tape to reveal a photo sticker.\n\nThe photo shows Dallas and a woman, both wearing heavy audio headsets, laughing in a field of grass.\n\nDallas's thumb rushes over her face. He holds the contact for a beat too long.\n\nDallas presses the sticker on the side of his new receiver.\n\nAs he does this, he hears a HUM.\n\nDallas records readings, but the battery dies.\n\nDALLAS\n(to himself)\nDamn.\n\nHe sets the receiver down and heads for the door.\n\n\n---\n\n\n### Scene 2: The Hum\n\n*ACT I — Arrival & Discovery | ID: the-hum | File: 02_the-hum.md*\n\n---\n\nEXT. BRANFORD STREET - DAY\n\nDallas walks into town for batteries. On the way, he meets his neighbor DOMINIC.\n\nDOMINIC\nHey there! You're the new guy, right?\n\nDALLAS\nYeah. Dallas.\n\nDOMINIC\nDominic. Nice to meet you. Heading into town?\n\nDALLAS\nJust need batteries.\n\nDOMINIC\nI'll walk with you. Got some errands myself.\n\nThey walk together. As they approach the town center, Dallas notices a row of BIRDS perched on a power line. All facing the direction towards the marsh.\n\nDALLAS\nThat's... unusual.\n\nDOMINIC\nWhat?\n\nDALLAS\nThe birds. All facing the same direction.\n\nDOMINIC\n(shrugs)\nCoastal birds. They do that.\n\nBut Dallas can't shake the feeling. Something's off.\n\n\n---\n\n\n### Scene 3: The Fellowship\n\n*ACT I — Arrival & Discovery | ID: fellowship | File: 03_fellowship.md*\n\n---\n\nEXT. CHURCH FELLOWSHIP HALL - LATE AFTERNOON\n\nDallas and Dominic arrive at CPC and find themselves in a circle with other churchgoers outside, eating at the fellowship hall.\n\nIt's the last fellowship hall lunch of the summer. Late summer light filters through the trees.\n\nDOMINIC\nThis is Sally's famous casserole. You gotta try it.\n\nDALLAS\nThanks.\n\nDallas takes a plate but doesn't eat much. He's distracted, listening.\n\nDOMINIC\nSo, what are you here for?\n\nDALLAS\nWork.\n\nDOMINIC\nAt Yale?\n\nDALLAS\nQuinnipiac. Starting next semester. Got a couple months to get settled.\n\nDOMINIC\nNice. So are you here alone?\n\nDALLAS\nYep.\n\nDOMINIC\nOkay cool. That's cool.\n\nThey finish eating. The group begins to disperse.\n\nDOMINIC\nWant to walk back together? I'll show you around.\n\nDALLAS\nSure.\n\nThey start walking towards the marsh, towards the New England coast.\n\nIn the far distance, COYOTES HOWL.\n\n\n---\n\n\n### Scene 4: Parking Ticket\n\n*ACT I — Arrival & Discovery | ID: parking-ticket | File: 04_parking_ticket.md*\n\n---\n\nEXT. TOWN CENTER - DAY\n\nDallas and Dominic walk toward a small hardware store. Dominic stops dead. A neon orange ticket flutters under his windshield wiper.\n\nDOMINIC\nYou have got to be kidding me! \n\nHe rips the ticket off, waving it at the empty street.\n\nDOMINIC (CONT'D)\nTwelve minutes! I was gone twelve minutes. You see this, Dallas? This is where the taxes go. Not to fixing the potholes or the raccoon problem—oh no—it goes to the guy with the ticket book.\n\nDALLAS\nRaccoon problem?\n\nDOMINIC\nThey’re everywhere. Knocking over bins, tearing up siding. Bold, too. They don’t even run anymore.\n\nDallas isn’t looking at the ticket. He’s looking up. On a sagging power line, thirty birds sit in a perfect, silent row. They aren't preening or chirping. Every single beak is pointed South-East. Toward the marsh.\n\nDALLAS\nDominic. Look at the birds.\n\nDominic glances up, then back at his ticket, uncaring.\n\nDOMINIC\nProbably waiting for a hand-out. Come on, let’s get your batteries before I get another fine for standing still.\n\n\n---\n\n\n### Scene 5: Marsh Walk\n\n*ACT I — Arrival & Discovery | ID: marsh-walk | File: 05_marsh_walk.md*\n\n---\n\nEXT. MARSH TRAIL - LATER\n\nThe sun is dipping. Dallas and Dominic walk along a wooden boardwalk that cuts through the tall, golden-yellow reeds. \n\nDominic pulls out his phone, tapping an app. \n\nDOMINIC\nSee this? Merlins. It listens to the chirps and tells you the species. Coastal stuff mostly—Egret, Plover. You should get it if you're working at Quinnipiac.\n\nDallas pulls out his own military-grade receiver. He adjusts a dial. Through his heavy headsets, he doesn't hear birds. He hears a low, rhythmic THRUB-THRUB-THRUB.\n\nDALLAS\nI prefer the raw feed.\n\nDOMINIC\nSuit yourself. But there’s a spot near the old creek where the Coyotes gather. Sounds like a choir of demons at 2 AM. You'll hear 'em soon enough.\n\nDallas stops. He looks into the thick grass. The wind moves the reeds, but it looks like something else is moving *underneath* them, contrary to the breeze.\n\n\n---\n\n\n### Scene 6: News Vans\n\n*ACT I — Arrival & Discovery | ID: news-vans | File: 06_news_vans.md*\n\n---\n\nEXT. BRANFORD COMMON - CONTINUOUS\n\nThey reach the town green. Three news vans are parked haphazardly. PAT CLENDENEN, a local weatherman with an overly bright tie, adjusts his earpiece in front of a camera.\n\nPAT CLENDENEN\n(to camera)\n...and while we’re all hoping the Nor'easter stays out at sea, the current models suggest a wild weekend for the shoreline. Hopefully, it holds off until after Sunday’s festival, but folks, get those generators ready!\n\nDominic scoffs as they walk past.\n\nDOMINIC\nPat’s been predicting the end of the world every Tuesday for ten years. \n\nDALLAS\nHe mentioned the wind. It’s picking up.\n\nThe wind gusts, catching a news umbrella and nearly toppling it. The hum in Dallas's pocket receiver spikes for a split second.\n\n\n---\n\n\n### Scene 7: Trash Cans\n\n*ACT I — Arrival & Discovery | ID: trash-cans | File: 07_trash_cans.md*\n\n---\n\nEXT. DOMINIC'S HOUSE - LATER\n\nThey arrive back at Dominic's. Two large plastic trash bins are sprawled across the driveway, trash strewn everywhere. \n\nDOMINIC\nThose damn raccoons! I just put these out!\n\nDominic kicks a stray milk carton. He looks at his front door, then at Dallas.\n\nDOMINIC (CONT'D)\nLook, I gotta clean this up and get the furniture moved before the life group meeting tonight. The kids left the place a wreck. You mind helping me move the heavy sofa? I’ll buy you a beer.\n\nDALLAS\n(hesitates)\nSure. Just for a minute.\n\n\n---\n\n\n### Scene 8: The Coordinates\n\n*ACT I — Arrival & Discovery | ID: the-coordinates | File: 08_the_coordinates.md*\n\n---\n\nINT. DOMINIC'S LIVING ROOM - CONTINUOUS\n\nThe house smells like old wood and floor wax. Dallas helps Dominic shove a heavy oak table against the wall.\n\nDallas stops. On the wall is a small, framed photo of a woman and a young boy. \n\nDOMINIC\nMy wife and kid. They're... gone now. \n\nDominic looks toward the corner. MR. MIKE (70s) sits in a rocking chair, staring fixedly at the floor. He is scratching something into the wood of the end table with a jagged fingernail.\n\nDOMINIC (CONT'D)\nI take care of him. He’s had a rough go since the weather changed.\n\nMr. Mike suddenly looks up, his eyes milky but sharp. He points a gnarled finger at the window.\n\nMR. MIKE\n[TODO: Mr. Mike dialogue]\n\n\n---\n\n\n### Scene 9: Janice Arrival\n\n*ACT I — Arrival & Discovery | ID: janice-arrival | File: 09_janice_arrival.md*\n\n---\n\nINT. DOMINIC'S KITCHEN - LATE AFTERNOON\n\nThe front door slams open. JANICE (40s) marches in, balancing two bags of groceries and a set of keys between her teeth. Behind her, ASHER (15) and MAKAYLA (22) trudge in, staring at their phones.\n\nJANICE\n(spitting out keys)\nThe traffic on I-95 is a literal nightmare. Dominic, why are you cooking the sprouts already? They’ll be mush by the time the group gets here.\n\nDOMINIC\nI’m following the recipe, Janice.\n\nJANICE\n(inspecting the pot)\nYou’re boiling them? You’re supposed to roast them! And the gravy—is that a lump? \n\nJanice begins a frantic search for her keys, which she just put down. She stumbles over Dallas’s heavy receiver on the floor.\n\nJANICE (CONT'D)\nWhat is this? A boat anchor?\n\nDALLAS\nIt’s a receiver. For work.\n\nDominic ushers everyone toward the car for a quick errand. The kitchen is a whirlwind of coats, overlapping arguments, and the smell of scorched sprouts.\n\n\n---\n\n\n### Scene 10: Equipment Intro\n\n*ACT I — Arrival & Discovery | ID: equipment-intro | File: 10_equipment_intro.md*\n\n---\n\nINT. DOMINIC'S HOUSE - CONTINUOUS\n\nMakayla stops by Dallas's equipment. She doesn't look at it with Janice's annoyance; she looks with genuine curiosity.\n\nMAKAYLA\nThis is military grade. What are you tracking? \n\nDALLAS\nBioacoustics. Sounds in the marsh.\n\nMAKAYLA\nDoes it pick up frequencies below the human range? I heard something last night. Like a vibrating lung.\n\nAsher, meanwhile, stands by the window. He ignores the conversation, his eyes fixed on the distant bushes at the edge of the property. The leaves ripple, though there is no wind.\n\nDOMINIC\n(yelling from the door)\nEveryone in the car! We’re going to be late! Dallas, thanks for watching Howie!\n\nThe family vanishes in a blur of activity, leaving Dallas standing in the sudden, ringing silence with HOWIE, the small dog.\n\n\n---\n\n\n### Scene 11: Howie Walk\n\n*ACT I — Arrival & Discovery | ID: howie-walk | File: 11_howie_walk.md*\n\n---\n\nEXT. BRANFORD ROCKS - EVENING\n\nThe Long Island Sound roars, the waves crashing violently against the Branford rocks. Dallas walks Howie along the perimeter of his new property.\n\nDallas holds his portable reader out. The needle isn't just moving; it's spiking. The closer they get to the tall grass, the more violent the readings become.\n\nDALLAS\n(to himself)\nWhat are you?\n\nHowie stops. His ears perk up, swiveling like small radar dishes toward the dark reeds. \n\nIn the far distance, a single dog barks. Then another. A chain reaction of domestic fear starts in the neighborhood, followed by the high, thin yip of coyotes further inland.\n\nDallas pulls out his phone. A \"Severe Weather Alert\" pops up: STORM WARNING. \n\n\n---\n\n\n### Scene 12: The First Hum\n\n*ACT I — Arrival & Discovery | ID: the-first-hum | File: 12_the_first_hum.md*\n\n---\n\nEXT. EDGE OF THE MARSH - CONTINUOUS\n\nEverything goes still. The wind stops. The waves seem to mute themselves.\n\nThen, the HUM begins. \n\nIt starts as a vibration in Dallas's teeth, then moves to his chest. It is a deep, dense, multi-layered sound—a living reed being forced through a massive throat.\n\nDallas stands in a daze, his hand tightening on Howie’s leash. The tall grass doesn't just sway; it pulses in time with the sound.\n\nDALLAS\n(whispering)\nThat's not the wind.\n\nHowie lets out a low, whimpering growl and tugs hard on the leash, pulling Dallas back toward the safety of the porch. \n\n\n---\n\n\n### Scene 13: Shadows in Wind\n\n*ACT I — Arrival & Discovery | ID: shadows-in-wind | File: 13_shadows_in_wind.md*\n\n---\n\nINT. DALLAS' HOUSE - NIGHT\n\nDallas stands at the window, staring into the ripping field. The storm is brewing, but the movement in the grass is wrong.\n\nShadows—tall, spindly, and darker than the night—grow in the distance. They move *against* the wind, cutting through the blades of grass like silent ships. \n\nHe touches the photo of his late wife on the side of the receiver. The contact is long, desperate. \n\nThe hum begins again, lower this time. His equipment remains silent, unable to register the frequency, but the windows of the house begin to rattle in their frames. \n\nIn the darkness of the marsh, something stares back.\n\n\n---\n\n\n## ACT II — The Creature\n\n---\n\n\n### Scene 14: The Burn Mark\n\n*ACT II — The Creature | ID: the-burn-mark | File: 14_the_burn_mark.md*\n\n---\n\nEXT. DALLAS'S BACKYARD - DAWN\n\nThe morning air is thick with the scent of ozone. Janice’s minivan idles in the driveway. She drops Howie off, barely waving as she rushes toward the museum to secure artwork before the storm hits.\n\nMakayla and Asher don't follow her. They wander toward the edge of Dallas’s property. \n\nMAKAYLA\nAsher, look.\n\nIn the middle of the yard is a jagged, blackened circle—a burn mark in the grass. At its center lies a small, translucent crystal. \n\nMakayla kneels and touches it. Her hair begins to flutter, static electricity pulling the strands toward the stone. She quickly pockets it as Dominic yells from the car.\n\n\n---\n\n\n### Scene 15: Costco Run\n\n*ACT II — The Creature | ID: costco-run | File: 15_costco_run.md*\n\n---\n\nEXT. DALLAS'S PORCH - CONTINUOUS\n\nDominic emerges from the minivan, looking harried. He hands Dallas a stack of photocopied papers.\n\nDOMINIC\nLife group tonight. Thanks for hosting. I’m heading to Costco—need anything? Water? Batteries?\n\nDALLAS\nI’m good.\n\nDOMINIC\nSchools are canceled already. The kids are going to be underfoot all day. Try to keep ‘em out of the marsh, alright?\n\nDominic peels out. Dallas looks at the papers, then at the tall grass. It feels like the field is breathing.\n\n\n---\n\n\n### Scene 16: Entering Grass\n\n*ACT II — The Creature | ID: entering-grass | File: 16_entering_grass.md*\n\n---\n\nEXT. MARSH TRAIL - DAY\n\nDallas walks the coastal trail with Howie. Suddenly, the air vibrates. A roar-hum hybrid sound erupts from the reeds. \n\nHowie whines, pressing against Dallas’s leg. In the distance, a flicker of golden light pulses deep within the marsh. Dallas is drawn to it, his movements rhythmic and dazed.\n\nHis handheld scope chirps. The waveform is no longer random; it’s a repeating, melodic pattern. \n\nDALLAS\n(to Howie)\nStay here.\n\nHe ties Howie’s leash to a stunted cedar tree and steps off the path, disappearing into the golden-yellow reeds.\n\n\n---\n\n\n### Scene 17: The Hollow\n\n*ACT II — The Creature | ID: the-hollow | File: 17_the_hollow.md*\n\n---\n\nEXT. TALL GRASS HOLLOW - CONTINUOUS\n\nThe reeds are so high they block the sun. Dallas pushes through to a small clearing—a shrunken tree hollow surrounded by dead leaves.\n\nA cry rings out. It’s not a throat-sound; it’s air being forced through something hollow. \n\nDallas kneels. Inside the pile of leaves, something is moving. He clears the debris to reveal a small, birdlike creature covered in downy fur with long, rabbit-like ears.\n\nA flickering glow emanates from its neck. Its \"back-holes\"—delicate vents along its spine—vibrate as it breathes, creating the sound that syncs perfectly with Dallas's receiver.\n\n\n---\n\n\n### Scene 18: Creature Rescue\n\n*ACT II — The Creature | ID: creature-rescue | File: 18_creature_rescue.md*\n\n---\n\nEXT. TALL GRASS HOLLOW - CONTINUOUS\n\nThe creature’s pulse is slowing. The glow in its neck dims. \n\nDallas reaches out, his fingers trembling. As he touches the creature's back, the vibration softens. The creature quiets, its breathing lining up with the hum of his equipment.\n\nHe notices the creature was lying on a second crystal, similar to the one Makayla found. \n\nAs Dallas lifts the fragile thing toward his chest, it lets out a faint, melodic whimper before fainting. The scope in his pocket goes silent. \n\nDALLAS\nI've got you.\n\nSuddenly, the wind changes. A heavy, crushing sound approaches through the ree\n\n[TODO: finish this beat / complete last line]\n\n\n---\n\n\n### Scene 19: The Escape\n\n*ACT II — The Creature | ID: the-escape | File: 19_the_escape.md*\n\n---\n\n# The Escape\n\n*TODO: Something massive follows through the grass; Dallas runs.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 20: Makeshift Hospital\n\n*ACT II — The Creature | ID: makeshift-hospital | File: 20_makeshift_hospital.md*\n\n---\n\n# Makeshift Hospital\n\n*TODO: Kitchen: Oscilloscope pulses with the creature's heart.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 21: Life Group Arrives\n\n*ACT II — The Creature | ID: life-group-arrives | File: 21_life_group_arrives.md*\n\n---\n\n# Life Group Arrives\n\n*TODO: Dominic and Mr. Mike return; the first family (JP) arrives.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 22: Basement Huddle\n\n*ACT II — The Creature | ID: basement-huddle | File: 22_basement_huddle.md*\n\n---\n\n# Basement Huddle\n\n*TODO: Dallas hides the creature; Makayla offers a sugar cube.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 23: The Hymn\n\n*ACT II — The Creature | ID: the-hymn | File: 23_the_hymn.md*\n\n---\n\n# The Hymn\n\n*TODO: Life group sings; the hum increases in volume/response. [cite: 2026-01-05]*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 24: Red Eyes\n\n*ACT II — The Creature | ID: red-eyes | File: 24_red_eyes.md*\n\n---\n\n# Red Eyes\n\n*TODO: Night 2: Dallas sees red eyes circling his property.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 25: Creature Missing\n\n*ACT II — The Creature | ID: creature-missing | File: 25_creature_missing.md*\n\n---\n\n# Creature Missing\n\n*TODO: The creature is gone; Janice finds burn marks on her van.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n## ACT III — The Return\n\n---\n\n\n### Scene 26: Marsh Confrontation\n\n*ACT III — The Return | ID: marsh-confrontation | File: 26_marsh_confrontation.md*\n\n---\n\n# Marsh Confrontation\n\n*TODO: Dallas/Makayla find the elders; the mist paralysis.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 27: Predator Attack\n\n*ACT III — The Return | ID: predator-attack | File: 27_predator_attack.md*\n\n---\n\n# Predator Attack\n\n*TODO: Red eyes snatch the golden lights; Dallas grabs the creature.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 28: The Perimeter\n\n*ACT III — The Return | ID: the-perimeter | File: 28_the_perimeter.md*\n\n---\n\n# The Perimeter\n\n*TODO: Dallas and Dominic build the copper wire/pole fence.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n### Scene 29: The Last Dinner\n\n*ACT III — The Return | ID: the-last-dinner | File: 29_the_last_dinner.md*\n\n---\n\n# The Last Dinner\n\n*TODO: Silent dinner; Mr. Mike chants \"115.3 MHz\" repeatedly.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n\n## ACT IV — Aftermath\n\n---\n\n\n### Scene 30: Final Echoes\n\n*ACT IV — Aftermath | ID: final-echoes | File: 30_final_echoes.md*\n\n---\n\n# Final Echoes\n\n*TODO: Morning after: Pat's report; Dallas records the alphabet.*\n\n---\n\nINT./EXT. TBD - TBD\n\n[Write scene here]\n\n\n---\n\n";
    const container = document.getElementById('scriptContent');
    marked.setOptions({ breaks: true });
    container.innerHTML = marked.parse(markdown);
    
    // Format screenplay elements
    formatScreenplay(document.querySelector('.screenplay-container'));
    
    function formatScreenplay(container) {
      const content = container.querySelector('.screenplay-content');
      if (!content) return;

      normalizeParagraphBreaks(content);

      const paragraphs = content.querySelectorAll('p');
      let inDialogueBlock = false;
      
      paragraphs.forEach((p, index) => {
        const text = p.textContent.trim();
        const nextP = paragraphs[index + 1];
        const prevP = paragraphs[index - 1];
        
        // Skip if already formatted or empty
        if (!text || p.classList.length > 0) return;
        
        // Scene headings (INT. or EXT. at start of line)
        if (/^(INT\.|EXT\.)/i.test(text)) {
          p.className = 'scene-heading';
          p.textContent = text.toUpperCase();
          inDialogueBlock = false;
          return;
        }
        
        // Transitions (right-aligned, uppercase)
        if (/^(FADE IN|FADE OUT|CUT TO|DISSOLVE TO|SMASH CUT|MATCH CUT)/i.test(text)) {
          p.className = 'transition';
          p.textContent = text.toUpperCase();
          inDialogueBlock = false;
          return;
        }
        
        // Parentheticals (text in parentheses, italic) - check before character names
        if (/^\(.+\)$/.test(text)) {
          p.className = 'parenthetical';
          inDialogueBlock = true;
          return;
        }
        
        // Character names (all caps, typically short, not scene headings)
        const isAllCaps = /^[A-Z][A-Z\s\.'-]+$/.test(text) && text === text.toUpperCase();
        const isReasonableLength = text.length > 2 && text.length < 35;
        const isNotSceneHeading = !/^(INT\.|EXT\.|FADE|CUT|DISSOLVE)/i.test(text);
        
        if (isAllCaps && isReasonableLength && isNotSceneHeading) {
          const nextText = nextP ? nextP.textContent.trim() : '';
          const looksLikeDialogue = nextText && (
            /^\(.+\)$/.test(nextText) ||
            (!/^(INT\.|EXT\.|FADE|CUT|DISSOLVE)/i.test(nextText) && 
             !/^[A-Z][A-Z\s\.'-]+$/.test(nextText))
          );
          
          if (looksLikeDialogue || !prevP || prevP.classList.contains('action-line') || prevP.classList.contains('scene-heading')) {
            p.className = 'character-name';
            inDialogueBlock = true;
            return;
          }
        }
        
        // Dialogue (follows character name / parenthetical / dialogue)
        const looksLikeNewBlock = /^(INT\.|EXT\.|FADE IN|FADE OUT|CUT TO|DISSOLVE TO|SMASH CUT|MATCH CUT)/i.test(text);
        const looksLikeCharacter = isAllCaps && isReasonableLength && isNotSceneHeading;
        if (!looksLikeNewBlock && inDialogueBlock && prevP && (prevP.classList.contains('character-name') || prevP.classList.contains('parenthetical') || prevP.classList.contains('dialogue'))) {
          p.className = 'dialogue';
          inDialogueBlock = true;
          return;
        }
        
        // If we're in a dialogue block but this doesn't match, end the block
        if (looksLikeCharacter || looksLikeNewBlock) {
          inDialogueBlock = false;
        }
        
        // Default: action line
        p.className = 'action-line';
        inDialogueBlock = false;
      });

      // Add markers for last line in dialogue / parenthetical blocks (spacing)
      const ps = content.querySelectorAll('p');
      ps.forEach((p, i) => {
        if (!p.classList.contains('dialogue') && !p.classList.contains('parenthetical')) return;
        const next = ps[i + 1];
        if (!next || (!next.classList.contains('dialogue') && !next.classList.contains('parenthetical'))) {
          if (p.classList.contains('dialogue')) p.classList.add('dialogue-last');
          if (p.classList.contains('parenthetical')) p.classList.add('parenthetical-last');
        }
      });
    }

    // Split <p> blocks that contain <br> into separate <p>s per line.
    // This lets screenplay formatting work even if the markdown uses single newlines.
    function normalizeParagraphBreaks(content) {
      const paragraphs = Array.from(content.querySelectorAll('p'));
      paragraphs.forEach((p) => {
        if (!p.querySelector('br')) return;
        const parts = p.innerHTML
          .split(/<br\s*\/?\s*>/i)
          .map((s) => s.replace(/&nbsp;/g, ' ').trim())
          .filter(Boolean);
        if (parts.length <= 1) return;

        const frag = document.createDocumentFragment();
        parts.forEach((html) => {
          const np = document.createElement('p');
          np.classList.add('line-split');
          np.innerHTML = html;
          frag.appendChild(np);
        });
        p.replaceWith(frag);
      });
    }
  </script>
</body>
</html>